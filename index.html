<!DOCTYPE html>
<html>
<head>
    <title>CS:GO Case Opening</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --bg-color: #1e1e1e;
            --case-color: #2a2a2e;
            --primary: #5d8aff;
            --rare: #ffcc00;
            --legendary: #ff4d4d;
        }
        body {
            font-family: 'Arial', sans-serif;
            background: var(--bg-color);
            color: white;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
        }
        .header {
            display: flex;
            justify-content: space-between;
            padding: 15px;
            background: #2a2a2a;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 100;
        }
        .balance {
            background: var(--primary);
            padding: 5px 10px;
            border-radius: 10px;
            font-weight: bold;
        }
        .container {
            margin-top: 70px;
            padding-bottom: 60px;
        }
        .case {
            background: var(--case-color);
            border-radius: 15px;
            margin: 15px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            transition: transform 0.3s;
        }
        .case:hover {
            transform: scale(1.03);
            cursor: pointer;
        }
        .case-image {
            width: 200px;
            height: 150px;
            object-fit: contain;
            margin-bottom: 10px;
        }
        .btn {
            background: var(--primary);
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            font-weight: bold;
            cursor: pointer;
            margin: 5px;
        }
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        .modal-content {
            background: var(--case-color);
            padding: 20px;
            border-radius: 15px;
            width: 90%;
            max-width: 400px;
            max-height: 80vh;
            overflow-y: auto;
        }
        .roulette-container {
            display: flex;
            overflow-x: auto;
            padding: 20px 0;
            scroll-snap-type: x mandatory;
        }
        .item-card {
            flex: 0 0 auto;
            width: 120px;
            margin: 0 10px;
            scroll-snap-align: center;
            text-align: center;
        }
        .item-image {
            width: 100px;
            height: 100px;
            object-fit: contain;
            margin-bottom: 5px;
        }
        .rarity-common { color: #ffffff; }
        .rarity-rare { color: var(--rare); }
        .rarity-legendary { color: var(--legendary); }
        .roulette {
            animation: scroll 10s linear infinite;
        }
        @keyframes scroll {
            0% { transform: translateX(0); }
            100% { transform: translateX(-100%); }
        }
        .fast-roulette {
            animation: fastScroll 2s linear infinite;
        }
        @keyframes fastScroll {
            0% { transform: translateX(0); }
            100% { transform: translateX(-100%); }
        }
        .selected-item {
            border: 3px solid var(--primary);
            box-shadow: 0 0 20px var(--primary);
        }
    </style>
</head>
<body>
    <div class="header">
        <div id="profile-btn">üë§ –ü—Ä–æ—Ñ–∏–ª—å</div>
        <div class="balance" id="balance">1000 coins</div>
    </div>

    <div class="container">
        <h2 style="text-align: center;">–í—ã–±–µ—Ä–∏—Ç–µ –∫–µ–π—Å</h2>
        
        <!-- –û—Ä—É–∂–µ–π–Ω—ã–π –∫–µ–π—Å -->
        <div class="case" onclick="showCaseContents('weapon')">
            <img src="weapon_case.png" class="case-image" alt="–û—Ä—É–∂–µ–π–Ω—ã–π –∫–µ–π—Å">
            <h3>–û—Ä—É–∂–µ–π–Ω—ã–π –∫–µ–π—Å</h3>
            <p>–¶–µ–Ω–∞: 100 coins</p>
        </div>

        <!-- –ù–æ–∂–µ–≤–æ–π –∫–µ–π—Å -->
        <div class="case" onclick="showCaseContents('knife')">
            <img src="knife_case.png" class="case-image" alt="–ù–æ–∂–µ–≤–æ–π –∫–µ–π—Å">
            <h3>–ù–æ–∂–µ–≤–æ–π –∫–µ–π—Å</h3>
            <p>–¶–µ–Ω–∞: 500 coins</p>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –∫–µ–π—Å–∞ -->
    <div class="modal" id="case-contents-modal">
        <div class="modal-content">
            <h3 id="case-title">–°–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–µ–π—Å–∞</h3>
            <div class="roulette-container" id="case-items-container"></div>
            <button class="btn" onclick="startCaseOpening()">–û—Ç–∫—Ä—ã—Ç—å (100 coins)</button>
            <button class="btn" onclick="closeModal('case-contents-modal')">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä—É–ª–µ—Ç–∫–∏ -->
    <div class="modal" id="roulette-modal">
        <div class="modal-content">
            <h3>–û—Ç–∫—Ä—ã—Ç–∏–µ –∫–µ–π—Å–∞</h3>
            <div class="roulette-container" id="roulette"></div>
            <button class="btn" id="stop-btn" style="display: none;" onclick="stopRoulette()">–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ -->
    <div class="modal" id="result-modal">
        <div class="modal-content" style="text-align: center;">
            <h3>üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!</h3>
            <img id="result-image" src="" style="width: 150px; height: 150px; object-fit: contain;">
            <h4 id="result-name"></h4>
            <p id="result-rarity"></p>
            <p id="result-value"></p>
            <button class="btn" onclick="addToInventory()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å</button>
            <button class="btn" onclick="sellItem()">–ü—Ä–æ–¥–∞—Ç—å –∑–∞ <span id="sell-price"></span> coins</button>
        </div>
    </div>

    <script>
        // –î–∞–Ω–Ω—ã–µ –∫–µ–π—Å–æ–≤
        const cases = {
            weapon: {
                name: "–û—Ä—É–∂–µ–π–Ω—ã–π –∫–µ–π—Å",
                price: 100,
                items: [
                    { name: "AK-47 | –ö—Ä–∞—Å–Ω–∞—è –ª–∏–Ω–∏—è", rarity: "rare", image: "ak_redline.png", value: 200 },
                    { name: "AWP | –ß–µ—Ä–Ω—ã–π –≥—Ä–∏—Ñ–æ–Ω", rarity: "common", image: "awp_gryphon.png", value: 50 },
                    { name: "M4A4 | –ò–º–ø–µ—Ä–∞—Ç–æ—Ä", rarity: "legendary", image: "m4a4_emperor.png", value: 500 },
                    { name: "Desert Eagle | –ö–æ–±—Ä–∞", rarity: "rare", image: "deagle_cobra.png", value: 180 },
                    { name: "Glock-18 | –í–æ–¥–∞", rarity: "common", image: "glock_water.png", value: 30 }
                ]
            },
            knife: {
                name: "–ù–æ–∂–µ–≤–æ–π –∫–µ–π—Å",
                price: 500,
                items: [
                    { name: "–ö–µ—Ä–∞–º–±–∏—Ç | –£–ª—å—Ç—Ä–∞—Ñ–∏–æ–ª–µ—Ç", rarity: "legendary", image: "karambit_ultraviolet.png", value: 1000 },
                    { name: "–ù–∞–≤–∞—Ö–∞ | –ö—Ä–æ–≤–∞–≤–∞—è –ø–∞—É—Ç–∏–Ω–∞", rarity: "rare", image: "navaja_web.png", value: 600 },
                    { name: "–ë–∞–±—É—Ç–∫–∞ | –°–∏–Ω–∏–π —Å—Ç–∞–ª—å–Ω–æ–π", rarity: "rare", image: "butterfly_blue.png", value: 700 },
                    { name: "–°–∫–µ–ª–µ—Ç–Ω—ã–π –Ω–æ–∂ | –ö—Ä–∏–º—Å–æ–Ω", rarity: "legendary", image: "skeleton_crimson.png", value: 1200 },
                    { name: "–û—Ö–æ—Ç–Ω–∏—á–∏–π –Ω–æ–∂ | –õ–µ—Å", rarity: "rare", image: "huntsman_forest.png", value: 550 }
                ]
            }
        };

        // –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        let userData = {
            balance: 1000,
            username: null,
            userId: Math.floor(Math.random() * 1000000),
            inventory: []
        };

        let currentCase = null;
        let currentItem = null;
        let rouletteInterval = null;

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebApp
        Telegram.WebApp.expand();
        Telegram.WebApp.ready();

        // –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–µ–π—Å–∞
        function showCaseContents(caseType) {
            currentCase = caseType;
            const caseData = cases[caseType];
            document.getElementById('case-title').textContent = `–°–æ–¥–µ—Ä–∂–∏–º–æ–µ: ${caseData.name}`;
            
            const container = document.getElementById('case-items-container');
            container.innerHTML = '';
            
            caseData.items.forEach(item => {
                const itemCard = document.createElement('div');
                itemCard.className = 'item-card';
                itemCard.innerHTML = `
                    <img src="${item.image}" class="item-image">
                    <p class="rarity-${item.rarity}">${item.name}</p>
                    <p>${item.value} coins</p>
                `;
                container.appendChild(itemCard);
            });
            
            document.getElementById('roulette').innerHTML = container.innerHTML;
            openModal('case-contents-modal');
        }

        // –ù–∞—á–∞—Ç—å –æ—Ç–∫—Ä—ã—Ç–∏–µ –∫–µ–π—Å–∞
        function startCaseOpening() {
            if (userData.balance < cases[currentCase].price) {
                alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤!");
                return;
            }
            
            closeModal('case-contents-modal');
            openModal('roulette-modal');
            
            // –ó–∞–ø—É—Å–∫ —Ä—É–ª–µ—Ç–∫–∏
            const roulette = document.getElementById('roulette');
            roulette.className = 'roulette-container roulette';
            
            // –ß–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã —É—Å–∫–æ—Ä—è–µ–º
            setTimeout(() => {
                roulette.className = 'roulette-container fast-roulette';
                document.getElementById('stop-btn').style.display = 'block';
            }, 3000);
        }

        // –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä—É–ª–µ—Ç–∫—É
        function stopRoulette() {
            clearInterval(rouletteInterval);
            const roulette = document.getElementById('roulette');
            roulette.className = 'roulette-container';
            
            // –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–π –ø—Ä–µ–¥–º–µ—Ç
            const caseItems = cases[currentCase].items;
            currentItem = caseItems[Math.floor(Math.random() * caseItems.length)];
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            showResult();
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        function showResult() {
            closeModal('roulette-modal');
            
            document.getElementById('result-image').src = currentItem.image;
            document.getElementById('result-name').textContent = currentItem.name;
            document.getElementById('result-rarity').innerHTML = 
                `–†–µ–¥–∫–æ—Å—Ç—å: <span class="rarity-${currentItem.rarity}">${currentItem.rarity}</span>`;
            document.getElementById('result-value').textContent = `–¶–µ–Ω–∞: ${currentItem.value} coins`;
            document.getElementById('sell-price').textContent = Math.floor(currentItem.value * 0.7);
            
            openModal('result-modal');
        }

        // –î–æ–±–∞–≤–∏—Ç—å –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å
        function addToInventory() {
            userData.inventory.push(currentItem);
            userData.balance -= cases[currentCase].price;
            updateBalance();
            alert(`–ü—Ä–µ–¥–º–µ—Ç ${currentItem.name} –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å!`);
            closeModal('result-modal');
        }

        // –ü—Ä–æ–¥–∞—Ç—å –ø—Ä–µ–¥–º–µ—Ç
        function sellItem() {
            const sellPrice = Math.floor(currentItem.value * 0.7);
            userData.balance += sellPrice - cases[currentCase].price;
            updateBalance();
            alert(`–í—ã –ø—Ä–æ–¥–∞–ª–∏ –ø—Ä–µ–¥–º–µ—Ç –∑–∞ ${sellPrice} coins!`);
            closeModal('result-modal');
        }

        // –û–±–Ω–æ–≤–∏—Ç—å –±–∞–ª–∞–Ω—Å
        function updateBalance() {
            document.getElementById('balance').textContent = `${userData.balance} coins`;
        }

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–æ–¥–∞–ª—å–Ω—ã–º–∏ –æ–∫–Ω–∞–º–∏
        function openModal(id) {
            document.getElementById(id).style.display = 'flex';
        }

        function closeModal(id) {
            document.getElementById(id).style.display = 'none';
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        updateBalance();
    </script>
</body>
</html>
